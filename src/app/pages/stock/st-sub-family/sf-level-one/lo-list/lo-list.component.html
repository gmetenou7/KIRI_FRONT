<div *ngIf="loadingFamilies" class="flex align-items-center justify-content-center h-full w-full">
    <div class="text-success">
        <i class="pi pi-spin pi-spinner text-success" style="font-size: 3rem"></i>
    </div>
</div>

<div *ngIf="!loadingFamilies" class="">
    <div class="mt-3 lg:mt-0 flex justify-content-end">
        <button (click)="showSubFamilyViewDrawerAs='create'; onShowSubFamilyVieDrawer()" pButton pRipple
            label="Ajouter une sous famille" icon="pi pi-plus-circle">
        </button>
    </div>
    <div class="flex gap-2 w-full mt-4">
        <span class="p-input-icon-left mb-2 w-full">
            <i class="pi pi-search"></i>
            <input size="small" pInputText type="text" #filter placeholder="Chercher une sous famille de niveau 1"
                class="w-full" />
        </span>
    </div>

    <div class="text-900 w-full mt-3">
        <div class="grid mt-0 mr-0">
            <div *ngFor="let subFamily of displayedFamilies" class="col-12 md:col-4">
                <div
                    class="p-3 border-1 surface-border border-round surface-card flex justify-content-between align-items-end">
                    <div class="">
                        <div class="text-900 mb-2">
                            <span class="font-medium">{{subFamily.nom}}</span>
                        </div>
                        <div class="text-700">
                            {{subFamily.code_famille}}
                        </div>
                    </div>
                    <div class="">
                        <p-button
                            (onClick)="selectSubFamily=subFamily; showSubFamilyViewDrawerAs='update'; onShowSubFamilyVieDrawer() "
                            icon="pi pi-file-edit" [rounded]="true" [text]="true" size="small"></p-button>
                        <p-button
                            (onClick)="selectSubFamily=subFamily; showSubFamilyViewDrawerAs='detail'; onShowSubFamilyVieDrawer()"
                            icon="pi pi-eye" [rounded]="true" [text]="true" severity="success" size="small"></p-button>
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-4">
            <p-paginator (onPageChange)="onPageChange($event)" [first]="first" [rows]="rows"
                [totalRecords]="families.length" [rowsPerPageOptions]="[12, 24, 36]"></p-paginator>
        </div>
    </div>
</div>

<app-lo-view [families]="families" [drawerVisible]="showSubFamilyViewDrawer"
    (onDrawerClose)="onShowSubFamilyVieDrawer()" [useAs]="showSubFamilyViewDrawerAs" [subFamily]="selectSubFamily">

</app-lo-view>
<p-sidebar
  (onHide)="onDrawerHide()"
  [showCloseIcon] = "true"
  [dismissible]="false"
  [(visible)]="newMessageDrawer"
  styleClass="w-full lg:w-6"
  position="right"
>
  <ng-template pTemplate="header">
    <div class="flex align-items-center">
      <span class="flex align-items-center justify-content-center bg-blue-100 text-blue-800 mr-3 border-circle"
            style="width:32px;height:32px">
        <i class="pi pi-comment text-lg"></i>
      </span>
      <span class="font-medium text-2xl text-900">
        Nouveau message <span *ngIf="isPreSavedMessage">pré-enregistré</span>
      </span>
    </div>
  </ng-template>
  <div class="flex flex-column justify-content-between min-h-full surface-ground p-2">
    <div class="scrollbar p-3">
      <div class="grid formgrid p-fluid">
        <div class="field mb-4 col-12">
          <label class="mb-2 text-lg font-medium" for="language">Langue d'envois du message</label>
          <p-dropdown
            [(ngModel)]="selectedLanguage"
            [filter]="true"
            [options]="languages"
            id="language"
            placeholder="Choisir une langue"
            styleClass="w-full"
          >
            <ng-template pTemplate="selectedItem">
              <div class="flex align-items-center gap-2" *ngIf="selectedLanguage">
                <div>{{ selectedLanguage }}</div>
              </div>
            </ng-template>
            <ng-template let-option pTemplate="item">
              <div class="flex align-items-center gap-2">
                <div>{{ option }}</div>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
        <div *ngIf="!isPreSavedMessage" class="field mb-4 col-12">
          <label class="mb-2 text-lg font-medium" for="clients">Clients</label>
          <p-multiSelect id="clients" [(ngModel)]="selectedClients" [options]="clients" optionLabel="nom" placeholder="Selectionner les clients" display="chip" [showClear]="true"></p-multiSelect>
        </div>
        <div *ngIf="!isPreSavedMessage" class="field mb-4 col-12">
          <label class="mb-2 text-lg font-medium" for="channels">Cannaux</label>
          <p-dropdown
            [(ngModel)]="selectedChannel"
            [filter]="true"
            [options]="channels"
            id="channels"
            placeholder="Choisir le cannal d'envois"
            styleClass="w-full"
          >
            <ng-template pTemplate="selectedItem">
              <div class="flex align-items-center gap-2" *ngIf="selectedChannel">
                <div>{{ selectedChannel }}</div>
              </div>
            </ng-template>
            <ng-template let-option pTemplate="item">
              <div class="flex align-items-center gap-2">
                <div>{{ option }}</div>
              </div>
            </ng-template>
          </p-dropdown>
        </div>
        <div class="field mb-4 col-12">
          <label class="mb-2 text-lg font-medium" for="object">Objet</label>
          <input [value]="preSavedMessage?.object" id="object" pInputText type="text" placeholder="Objet du message" class="w-full" />
        </div>
        <div class="field mb-4 col-12">
          <label class="mb-2 text-lg font-medium" for="message">Message</label>
          <!--<p-editor [(ngModel)]="text" id="message" [style]="{ height: '320px' }"></p-editor>-->
          <textarea [value]="preSavedMessage?.message" id="message" type="text" pInputTextarea rows="5" [autoResize]="true"></textarea>
        </div>
        <div *ngIf="!isPreSavedMessage" class="field mb-4 col-12">
          <label class="mb-2 text-lg font-medium" for="files">Medias</label>
          <p-fileUpload
            id="files"
            removeStyleClass="bg-red-100 hover:bg-red-400 text-red-600 hover:text-white border-0 w-2rem h-2rem"
            [chooseIcon]="'pi pi-file'" [chooseLabel]="'Ajouter les fichiers'" [showCancelButton]="false"
            [showUploadButton]="false" name="demo[]" (onUpload)="onUpload($event)" [multiple]="true"
            accept="image/*" [maxFileSize]="1000000">
            <ng-template pTemplate="content">
              <ul class="flex" *ngIf="uploadedFiles.length">
                <li class="flex justify-content-start align-items-center gap-0" *ngFor="let file of uploadedFiles">
                </li>
              </ul>
            </ng-template>
          </p-fileUpload>
        </div>
      <div class="flex gap-2 align-items-center field mb-4 col-12">
        <p-checkbox value="New York" id="ny"></p-checkbox>
        <label for="ny">Garder la page active pour un nouvel envoi ?</label>
      </div>
      </div>
    </div>
  </div>
  <ng-template pTemplate="footer">
    <div class="flex justify-content-end gap-4">
      <button pButton pRipple icon="pi pi-send" (click)="newMessageDrawer =false" label="Envoyer"></button>
      <button pButton pRipple icon="pi pi-times" (click)="newMessageDrawer =false" label="Annuler"></button>
    </div>
  </ng-template>
</p-sidebar>
